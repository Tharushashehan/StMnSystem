DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'StMnSystem.Models.ApplicationDbContext'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201701190749047_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201701190749047_InitialCreate', N'StMnSystem.Models.ApplicationDbContext',  0x1F8B0800000000000400DD5C5B6FDB36147E1FB0FF20E8691B522B97B5E802BB45EA245BB0E6823A2DF656D012ED0895284DA2D204C37ED91EF693F617762851375E74B115DB29060CB578F89DC3C38FE4217998FFFEF977FCF6C1F78C7B1CC56E4026E6C168DF3430B103C725CB8999D0C58BD7E6DB37DF7F373E73FC07E3532E77C4E4A0268927E61DA5E1B165C5F61DF6513CF25D3B0AE260414776E05BC809ACC3FDFD5FAC83030B038409588631FE9010EAFA38FD013FA701B1714813E45D060EF662FE1D4A6629AA71857C1C87C8C61373462FC9EC31A6D81F65C2A671E2B9080C99616F611A889080220A661E7F8CF18C460159CE42F880BCDBC71083DC027931E6E61F97E25D5BB27FC85A62951573283B8969E0F7043C38E2AEB1C4EA2B39D82C5C07CE3B0327D347D6EAD48113F3C2C1E9A70F81070E10151E4FBD88094FCCCB42C5491C5E613ACA2B8E32C8F308E0BE06D197511571CFE85C6FAFA0D2E1689FFDB7674C138F26119E109CD008797BC64D32F75CFB77FC781B7CC1647274305F1CBD7EF90A3947AF7EC6472FAB2D85B6825CED037CBA89821047601B5E14ED370DAB5ECF122B16D52A7532AF0097605498C6257A788FC992DEC178397C6D1AE7EE0376F22F9C5C1F890B83082AD128819F5789E7A1B9878B72AB5127FB7F83D6C397AF06D17A85EEDD65DAF5827E1838118CAB0FD84B4BE33B37CC8657ADBF3F73B1F328F0D9EF3ABFB2D2CFB320896CD698402B728BA225A675EBC65649DE4E946650C3D33A47DD7D6A334B657A2B455983561909B98A4D8F86DCDEA7D5DB99712761089D97528B79A48970D25A35122AEF19A548499C83AEC421D0A06F791E3CF391EB0D301176D00221C8C28D7C5CB4F25D00B443A4B7CD37288E611E707E43F15D83E9F0CF014C9F613B89809E338AFCF0C9B5DDDC05045F25FE9CB17E73BA06EB9ADBAFC139B269109D11566B6DBCF781FD2548E819714E11C51FA99D03B29FB7AEDF1D6010734E6C1BC7F13990193BD30022EC1CF082D0A3C3DE706C7EDA762032F590EBAB23116126FD9C8B96D1885A428A483462AAA8A4C9D4F7C1D225DD4CCD45F5A66612ADA672B1BEA632B06E967249BDA1A940AB9D99D460715EDA43C3077A29ECEE477AEB2DDEBAB9A0E2C619CC90F8574C7004D398738328C511297BA0CBBCB18D6021ED3EA6F4C9D7A654D327E42543AB5A6934A493C0F0A32185DDFDD1909A099FEF5D8745251DB63FB930C0779257EFACDAC79C60D9A68743AD999B56BE993940375C4EE238B0DD7414280EBEF8B145DD7E88E18CF6338CAC35E23908340C88EEB2250FBE40DB4C9154D7E4147B9862E3C4CE0E06A728B69123BB111AE4F4302C5F51158695E72175E37E927402D371C42A21B6098A61A4BA84CAC3C225B61B22AFD54B42CD8E4B186B7BA1432C39C521264C61AB27BA28571F7F30030A3D42A7B479686C5518D74C444DD4AAEBF3B610B6EC77E95462239C6C899D35BCE4F1DB9310B3D9631B2067B34BBA18A03DCADB0641F95EA52B01C48DCBAE1154D8316908CA43AA8D10B4EEB12D10B4EE926747D06C8BDAB5FF85FDEAAED1B3BE51DEFCB2DEE8AE2D70B3E68F1DA366167B421D0A357024D3F374CE0AF103556CCEC04EBE3F8B79A82B528481CF30AD1FD994F1AE320EB59A414412350196446B01E59780129034A07A18979FE5355AC7A3881EB0F9B95B232C9FFB05D80A0764ECEA656845507F652A92B3D3EEA36859C10689E49D360B151C0521C4C9ABDEF00E4ED19DCBCA8EE9120BF789862B0DE39DD1E0A096C855E3A4BC31837B29A766BB975401599F906C2D2F09E193C64B796306F712E768BB931441418FB0602D17D597F081065B7ED251AC3645D9D8CA52A4F887B1A5C9A51A5FA23074C9B2925BC5BF18B32CB16AFA62D63FE5C8CF302C3B56641E15D6169A6810A125164A4135587AEE46313D4514CD113BE7993ABE24A65C5B35D37FAEB2BA7CCA9D98AF03B934FB37BF5995AEEE6B4BAD1C8B70887368A0CF029AF4145DD1FDEAEA064B75431E8A1407F7D3C04B7CA28FAFF4B5B3EBBB6AFDEC8B8C30B604FBA5F849729614E5D63DDFA95FE431314C1F15D1CBEAFDA487D0793B8F3DABFED6C5A37A94FC78AA8AA23BB2DA5ABFE9C2983E7D250688FDBBAA15E1694615CF4AA902F04F3D312A890D1258A5AC3B6A3DF7A48A592FE98E282498542185A21E5656D3486A46560B56C2D378542DD15D839C385245974BBB232B5248AAD08AE215B015368B65DD511559265560457177EC32E5449C437778DDD26E5B565DB8B28DED7A2B9706E36926C46116BECAFD7D15A8F2B92716BFA197C0F8F79D24937677B72A99B2E38CF5C8A4C1D0CF3BB58BEFFAB4D3785BAFC7ACDD66D7A6F6A6DB7C3D5E3FCA3E2931A4BD9D2852682FF678C25E6ECCF755ED8F67A48D5626621AB91B814E199598C068F6A737F55CCC26F15CE012117781639A65709887FB0787C2039CDD790C63C5B1E329F6A5BA1731F53EDB403216B947917D87223935628D072325A874EA7C411CFC3031FF4A6B1DA70718EC5FE9E73DE322FE48DC3F1328B88D126CFC2DA77A0E9340DFBCC3DAD1E70EDDBD7AF1C7E7ACEA9E711DC1883936F6055FAED2C3F54710BDACC9AAAE61CDCA4F239EEF80AABD3C50A20A0362F5870673970EF2C820B7F2071F3DFCD8D734E54382B510158F0586C21BC485BAC700AB60691F0238F093A60F01FA3556FD306015D3B48F025CD21F4C7C12D07D1ACA6B6E71A9516C89363125A57E6E4DA95E2BBF72DB6B939479BDD64097B3AB7BC0AD9141BD02339E59F2F160ABA322B77830EC6D52FBC9138A772587B8CCEED86EEAF026B3851BEE84BEA924E11D486B53A4E96C3F1578D35CD31DE3EE783E65BF84DF1D231B4FDEDA7E5AEFA6C9A63BE6DD71B2F54ADEDD31AE6D6BFDDC32D33A2FA15B4FC595B38A34D731AAB3E0B654DBECE01C76F8F30048904594D90B49756E57535E6A8BC25244AF549F54262A96068EA457926856DBAFAD7CC16F6C2C976956AB49C56CD2CDE7FF46DD5CA659B726C1711B49C2CA144355E276CB3CD69401F59C92826B2D69C9416F8B591BEFD69F530EF0204EA98D1ECD1DF1F349F91DC425430E9D1E29BEF2752FAC9D95BFA808EB77EC2E4B08F6F71509B66BAB662173411641BE780B16E522C209CD25A6C88125F524A2EE02D9148AD91973FAC43B3DB763371D73EC5C90EB8486098526637FEED50EBC5810D0A43FCD63AEDB3CBE0ED3BF56324413C04C979DCD5F937789EB3985DDE78A33210D048B2EF8892EEB4BCA4E76978F05D255403A0271F71541D12DF6430FC0E26B3243F77815DB807EEFF112D98FE509A00EA4BD23EA6E1F9FBA6819213FE618657DF8091C76FC8737FF03F5290BF858540000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201701191246381_AddMiddleName'
BEGIN
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201701191246381_AddMiddleName', N'StMnSystem.Models.ApplicationDbContext',  0x1F8B0800000000000400DD5C5B6FDB36147E1FB0FF20E8691B522B97B5E802BB45EA245BB0E6823A2DF656D012ED0895284DA2D204C37ED91EF693F617762851375E74B115DB29060CB578F89DC3C38FE4217998FFFEF977FCF6C1F78C7B1CC56E4026E6C168DF3430B103C725CB8999D0C58BD7E6DB37DF7F373E73FC07E3532E77C4E4A0268927E61DA5E1B165C5F61DF6513CF25D3B0AE260414776E05BC809ACC3FDFD5FAC83030B038409588631FE9010EAFA38FD013FA701B1714813E45D060EF662FE1D4A6629AA71857C1C87C8C61373462FC9EC31A6D81F65C2A671E2B9080C99616F611A889080220A661E7F8CF18C460159CE42F880BCDBC71083DC027931E6E61F97E25D5BB27FC85A62951573283B8969E0F7043C38E2AEB1C4EA2B39D82C5C07CE3B0327D347D6EAD48113F3C2C1E9A70F81070E10151E4FBD88094FCCCB42C5491C5E613ACA2B8E32C8F308E0BE06D197511571CFE85C6FAFA0D2E1689FFDB7674C138F26119E109CD008797BC64D32F75CFB77FC781B7CC1647274305F1CBD7EF90A3947AF7EC6472FAB2D85B6825CED037CBA89821047601B5E14ED370DAB5ECF122B16D52A7532AF0097605498C6257A788FC992DEC178397C6D1AE7EE0376F22F9C5C1F890B83082AD128819F5789E7A1B9878B72AB5127FB7F83D6C397AF06D17A85EEDD65DAF5827E1838118CAB0FD84B4BE33B37CC8657ADBF3F73B1F328F0D9EF3ABFB2D2CFB320896CD698402B728BA225A675EBC65649DE4E946650C3D33A47DD7D6A334B657A2B455983561909B98A4D8F86DCDEA7D5DB99712761089D97528B79A48970D25A35122AEF19A548499C83AEC421D0A06F791E3CF391EB0D301176D00221C8C28D7C5CB4F25D00B443A4B7CD37288E611E707E43F15D83E9F0CF014C9F613B89809E338AFCF0C9B5DDDC05045F25FE9CB17E73BA06EB9ADBAFC139B269109D11566B6DBCF781FD2548E819714E11C51FA99D03B29FB7AEDF1D6010734E6C1BC7F13990193BD30022EC1CF082D0A3C3DE706C7EDA762032F590EBAB23116126FD9C8B96D1885A428A483462AAA8A4C9D4F7C1D225DD4CCD45F5A66612ADA672B1BEA632B06E967249BDA1A940AB9D99D460715EDA43C3077A29ECEE477AEB2DDEBAB9A0E2C619CC90F8574C7004D398738328C511297BA0CBBCB18D6021ED3EA6F4C9D7A654D327E42543AB5A6934A493C0F0A32185DDFDD1909A099FEF5D8745251DB63FB930C0779257EFACDAC79C60D9A68743AD999B56BE993940375C4EE238B0DD7414280EBEF8B145DD7E88E18CF6338CAC35E23908340C88EEB2250FBE40DB4C9154D7E4147B9862E3C4CE0E06A728B69123BB111AE4F4302C5F51158695E72175E37E927402D371C42A21B6098A61A4BA84CAC3C225B61B22AFD54B42CD8E4B186B7BA1432C39C521264C61AB27BA28571F7F30030A3D42A7B479686C5518D74C444DD4AAEBF3B610B6EC77E95462239C6C899D35BCE4F1DB9310B3D9631B2067B34BBA18A03DCADB0641F95EA52B01C48DCBAE1154D8316908CA43AA8D10B4EEB12D10B4EE926747D06C8BDAB5FF85FDEAAED1B3BE51DEFCB2DEE8AE2D70B3E68F1DA366167B421D0A357024D3F374CE0AF103556CCEC04EBE3F8B79A82B528481CF30AD1FD994F1AE320EB59A414412350196446B01E59780129034A07A18979FE5355AC7A3881EB0F9B95B232C9FFB05D80A0764ECEA656845507F652A92B3D3EEA36859C10689E49D360B151C0521C4C9ABDEF00E4ED19DCBCA8EE9120BF789862B0DE39DD1E0A096C855E3A4BC31837B29A766BB975401599F906C2D2F09E193C64B796306F712E768BB931441418FB0602D17D597F081065B7ED251AC3645D9D8CA52A4F887B1A5C9A51A5FA23074C9B2925BC5BF18B32CB16AFA62D63FE5C8CF302C3B56641E15D6169A6810A125164A4135587AEE46313D4514CD113BE7993ABE24A65C5B35D37FAEB2BA7CCA9D98AF03B934FB37BF5995AEEE6B4BAD1C8B70887368A0CF029AF4145DD1FDEAEA064B75431E8A1407F7D3C04B7CA28FAFF4B5B3EBBB6AFDEC8B8C30B604FBA5F849729614E5D63DDFA95FE431314C1F15D1CBEAFDA487D0793B8F3DABFED6C5A37A94FC78AA8AA23BB2DA5ABFE9C2983E7D250688FDBBAA15E1694615CF4AA902F04F3D312A890D1258A5AC3B6A3DF7A48A592FE98E282498542185A21E5656D3486A46560B56C2D378542DD15D839C385245974BBB232B5248AAD08AE215B015368B65DD511559265560457177EC32E5449C437778DDD26E5B565DB8B28DED7A2B9706E36926C46116BECAFD7D15A8F2B92716BFA197C0F8F79D24937677B72A99B2E38CF5C8A4C1D0CF3BB58BEFFAB4D3785BAFC7ACDD66D7A6F6A6DB7C3D5E3FCA3E2931A4BD9D2852682FF678C25E6ECCF755ED8F67A48D5626621AB91B814E199598C068F6A737F55CCC26F15CE012117781639A65709887FB0787C2039CDD790C63C5B1E329F6A5BA1731F53EDB403216B947917D87223935628D072325A874EA7C411CFC3031FF4A6B1DA70718EC5FE9E73DE322FE48DC3F1328B88D126CFC2DA77A0E9340DFBCC3DAD1E70EDDBD7AF1C7E7ACEA9E711DC1883936F6055FAED2C3F54710BDACC9AAAE61CDCA4F239EEF80AABD3C50A20A0362F5870673970EF2C820B7F2071F3DFCD8D734E54382B510158F0586C21BC485BAC700AB60691F0238F093A60F01FA3556FD306015D3B48F025CD21F4C7C12D07D1ACA6B6E71A9516C89363125A57E6E4DA95E2BBF72DB6B939479BDD64097B3AB7BC0AD9141BD02339E59F2F160ABA322B77830EC6D52FBC9138A772587B8CCEED86EEAF026B3851BEE84BEA924E11D486B53A4E96C3F1578D35CD31DE3EE783E65BF84DF1D231B4FDEDA7E5AEFA6C9A63BE6DD71B2F54ADEDD31AE6D6BFDDC32D33A2FA15B4FC595B38A34D731AAB3E0B654DBECE01C76F8F30048904594D90B49756E57535E6A8BC25244AF549F54262A96068EA457926856DBAFAD7CC16F6C2C976956AB49C56CD2CDE7FF46DD5CA659B726C1711B49C2CA144355E276CB3CD69401F59C92826B2D69C9416F8B591BEFD69F530EF0204EA98D1ECD1DF1F349F91DC425430E9D1E29BEF2752FAC9D95BFA808EB77EC2E4B08F6F71509B66BAB662173411641BE780B16E522C209CD25A6C88125F524A2EE02D9148AD91973FAC43B3DB763371D73EC5C90EB8486098526637FEED50EBC5810D0A43FCD63AEDB3CBE0ED3BF56324413C04C979DCD5F937789EB3985DDE78A33210D048B2EF8892EEB4BCA4E76978F05D255403A0271F71541D12DF6430FC0E26B3243F77815DB807EEFF112D98FE509A00EA4BD23EA6E1F9FBA6819213FE618657DF8091C76FC8737FF03F5290BF858540000 , N'6.1.3-40302')
END

